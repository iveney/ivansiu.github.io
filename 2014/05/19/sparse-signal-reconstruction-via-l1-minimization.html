<!DOCTYPE html>
<!--
    So Simple Jekyll Theme 3.2.0
    Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
    Free for personal and commercial use under the MIT license
    https://github.com/mmistakes/so-simple-theme/blob/master/LICENSE
-->
<html lang="en-US" class="no-js">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  

  
    
    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Sparse Signal Reconstruction via L1-minimization | Ivan Xiao</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Sparse Signal Reconstruction via L1-minimization" />
<meta name="author" content="Ivan Xiao" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Engineer. Father. Cat Lover. Guitarist. Ballroom Dancer. Woodworker." />
<meta property="og:description" content="Engineer. Father. Cat Lover. Guitarist. Ballroom Dancer. Woodworker." />
<link rel="canonical" href="https://www.ivansiu.com/2014/05/19/sparse-signal-reconstruction-via-l1-minimization" />
<meta property="og:url" content="https://www.ivansiu.com/2014/05/19/sparse-signal-reconstruction-via-l1-minimization" />
<meta property="og:site_name" content="Ivan Xiao" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-05-19T03:13:08+00:00" />
<script type="application/ld+json">
{"url":"https://www.ivansiu.com/2014/05/19/sparse-signal-reconstruction-via-l1-minimization","@type":"BlogPosting","headline":"Sparse Signal Reconstruction via L1-minimization","dateModified":"2014-05-19T03:13:08+00:00","datePublished":"2014-05-19T03:13:08+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.ivansiu.com/2014/05/19/sparse-signal-reconstruction-via-l1-minimization"},"author":{"@type":"Person","name":"Ivan Xiao"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://www.ivansiu.com/images/xiao.png"},"name":"Ivan Xiao"},"description":"Engineer. Father. Cat Lover. Guitarist. Ballroom Dancer. Woodworker.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  

  <script>
    /* Cut the mustard */
    if ( 'querySelector' in document && 'addEventListener' in window ) {
      document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + 'js';
    }
  </script>

  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/skins/dark.css">
  <link rel="alternate" type="application/atom+xml" title="Ivan Xiao" href="/feed.xml">
<!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

<!-- end custom head snippets -->

</head>


  <body class="layout--post  sparse-signal-reconstruction-via-l1-minimization">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#primary-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    
  <div class="navigation-wrapper">
    <a href="#menu-toggle" id="menu-toggle">Menu</a>
    <nav id="primary-nav" class="site-nav animated drop">
      <ul><li><a href="/">Home</a></li><li><a href="/categories/">Categories</a></li><li><a href="/tags/">Tags</a></li><li><a href="/search/">Search</a></li></ul>
    </nav>
  </div><!-- /.navigation-wrapper -->


    <header class="masthead">
  <div class="wrap">
    
      <a href="/" class="site-logo" rel="home" title="Ivan Xiao">
        <img src="/images/xiao.png" class="site-logo-img animated fadeInDown" alt="Ivan Xiao">
      </a>
    
    
    
      
        <div class="site-title animated fadeIn"><a href="/">Ivan Xiao</a></div>
      
      <p class="site-description animated fadeIn" itemprop="description">Engineer. Father. Cat Lover. Guitarist. Ballroom Dancer. Woodworker.</p>
    
  </div>
</header><!-- /.masthead -->


    <main id="main" class="main-content" aria-label="Content">
  <article class="h-entry">
    

    <div class="page-wrapper">
      <header class="page-header">
        
        
          <h1 id="page-title" class="page-title p-name">Sparse Signal Reconstruction via L1-minimization
</h1>
        
      </header>

      <div class="page-sidebar">
        <div class="page-author h-card p-author"><img src="/images/ivan-memoji.jpg" class="author-avatar u-photo" alt="Ivan Xiao"><div class="author-info"><div class="author-name">
        <span class="p-name">Ivan Xiao</span>
      </div><ul class="author-links"><li class="author-link">
            <a class="u-url" rel="me" href="https://about.me/iveney"><i class="fas fa-external-link-square-alt fa-lg" title="About"></i></a>
          </li><li class="author-link">
            <a class="u-url" rel="me" href="https://twitter.com/ivanzxiao"><i class="fab fa-twitter-square fa-lg" title="Twitter"></i></a>
          </li><li class="author-link">
            <a class="u-url" rel="me" href="https://github.com/iveney"><i class="fab fa-github-square fa-lg" title="GitHub"></i></a>
          </li></ul>

<span class="read-time">2 min read</span>

    <time class="page-date dt-published" datetime="2014-05-19T03:13:08+00:00"><a class="u-url" href="">May 19, 2014</a>
</time>

  </div>
</div>

        
  <h3 class="page-taxonomies-title">Categories</h3>
  <ul class="page-taxonomies"><li class="page-taxonomy"><a class="p-category" href="/categories/#machine-learning" title="Pages filed under Machine Learning">Machine Learning</a></li><li class="page-taxonomy"><a class="p-category" href="/categories/#signal-processing" title="Pages filed under Signal Processing">Signal Processing</a></li>
  </ul>


        

      </div>

      <div class="page-content">
        <div class="e-content">
          <p><a href="https://res.cloudinary.com/maomao/image/upload/v1491291930/blog/l1/sparse_signal_reconstruction.png"><img src="https://res.cloudinary.com/maomao/image/upload/v1491291930/blog/l1/sparse_signal_reconstruction.png" alt="Sparse Signal Reconstruction Results" /></a></p>

<p>This is a follow-up of the <a href="#">previous post</a> on applications of L1 minimization.</p>

<!-- more -->

<p>As we know, any signal can be decomposed into a linear combination of basis,
and the most famous one is <a href="http://en.wikipedia.org/wiki/Fourier_transform">Fourier Transform</a>.
For simplicity, let’s assume that we have a signal that
is a superposition of some sinusoids. For example, the following:</p>

<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="nb">sin</span><span class="p">(</span><span class="mf">1.3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.*</span><span class="nb">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-.</span><span class="mi">7</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="mf">2.3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="n">x</span><span class="p">);</span></code></pre></figure>

<p>With <em>discrete consine transform</em> (DCT), we can easily find the coefficients of
corresponding sinusoid components. The above example’s coefficients (in
frequency domain) and signal in time domain are shown in the post figure.</p>

<p>Now, let’s assume we do not know the signal and want to reconstruct it
by sampling. Theorectically, the number of samples required is at least
two times the signal frequency, according to the famous
<a href="http://en.wikipedia.org/wiki/Nyquist–Shannon_sampling_theorem">Nyquist–Shannon sampling theorem</a>.</p>

<p>However, this assume zero-knowledge about the signal. If we know some structure
of the signal, e.g., the DCT coefficients are sparse in our case, we can
further reduce the number of samples required. <sup id="fnref:Nsamples" role="doc-noteref"><a href="#fn:Nsamples" class="footnote">1</a></sup></p>

<p>The following code snippet demonstrates how this works. We generate
the original signal in time domain and then perform a DCT to obtain the coefficients.</p>

<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="c1">% sparse signal recovery using L1</span>

<span class="nb">rng</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">256</span><span class="p">;</span> <span class="n">R</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">C</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

<span class="c1">% some superposition of sinoisoids, feel free to change and experiment</span>
<span class="n">f</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="nb">sin</span><span class="p">(</span><span class="mf">1.3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.*</span><span class="nb">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-.</span><span class="mi">7</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="mf">2.3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="n">x</span> <span class="o">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="nb">pi</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="nb">pi</span><span class="p">,</span> <span class="n">N</span><span class="p">);</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>

<span class="nb">subplot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">dct</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">'</span><span class="p">;</span>
<span class="nb">stem</span><span class="p">(</span><span class="n">coef</span><span class="p">);</span>
<span class="nb">xlim</span><span class="p">([</span><span class="mi">0</span> <span class="n">N</span><span class="p">]);</span> <span class="nb">title</span><span class="p">(</span><span class="s1">'Original signal in frequency domain'</span><span class="p">);</span>

<span class="nb">subplot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span>
<span class="nb">xlim</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)]);</span> <span class="nb">title</span><span class="p">(</span><span class="s1">'Original signal in time domain'</span><span class="p">);</span></code></pre></figure>

<p>Let’s assume that we have a device that can sample from the frequency domain.
To do this, we create a <em>random measurement matrix</em> to obtain the samples.
We use 80 samples here. Note that we normalize the measurement matrix
to have orthonormal basis, i.e., the norm of each row is 1, and the dot product
of different row is 0.</p>

<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="c1">% measurement matrix</span>
<span class="n">K</span><span class="o">=</span><span class="mi">80</span><span class="p">;</span>
<span class="n">A</span><span class="o">=</span><span class="nb">randn</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">N</span><span class="p">);</span>
<span class="n">A</span><span class="o">=</span><span class="nb">orth</span><span class="p">(</span><span class="n">A</span><span class="s1">')'</span><span class="p">;</span>

<span class="c1">% observations</span>
<span class="n">b</span><span class="o">=</span><span class="n">A</span><span class="o">*</span><span class="n">coef</span><span class="p">;</span></code></pre></figure>

<p>We first try a least-square approach, which boils down to inverse the matrix
and obtain \(\hat{x}=A^{-1} b\). Note that as A is not square, we are
using its <em>pseudo-inverse</em> here. Furthermore, as A is othornormal, its
transpose is the same as pseudo-inverse.</p>

<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="c1">% min-energy observations</span>
<span class="n">c0</span> <span class="o">=</span> <span class="n">A</span><span class="s1">'*b; % A'</span> <span class="o">=</span> <span class="nb">pinv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="n">here</span> <span class="n">since</span> <span class="n">A</span> <span class="n">is</span> <span class="n">a</span> <span class="nb">full</span><span class="o">-</span><span class="nb">rank</span> <span class="n">orthonormal</span> <span class="n">matrix</span>
<span class="nb">subplot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="nb">stem</span><span class="p">(</span><span class="n">c0</span><span class="p">);</span>
<span class="nb">xlim</span><span class="p">([</span><span class="mi">0</span> <span class="n">N</span><span class="p">]);</span> <span class="nb">title</span><span class="p">(</span><span class="s1">'Minimum energy recovery - coef'</span><span class="p">);</span>

<span class="nb">subplot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">idct</span><span class="p">(</span><span class="n">c0</span><span class="p">,</span> <span class="n">N</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span><span class="s1">'r'</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">);</span>
<span class="nb">xlim</span><span class="p">([</span><span class="mi">0</span> <span class="n">N</span><span class="p">]);</span> <span class="nb">title</span><span class="p">(</span><span class="s1">'Minimum energy recovery - signal'</span><span class="p">);</span>
<span class="nb">legend</span><span class="p">(</span><span class="s1">'Recovered'</span><span class="p">,</span> <span class="s1">'Original'</span><span class="p">);</span></code></pre></figure>

<p>As we can see, there are lots of non-zeros in the coefficients, and
the recovered signal is very different from the original signal.</p>

<p>Finally, we use L1-minimization for reconstruction. I used <code class="language-plaintext highlighter-rouge">lasso</code>
to perform a L1-regualarized minimization. Another package that performs various
L1-minimization is <a href="http://users.ece.gatech.edu/~justin/l1magic/">l1-magic</a>.</p>

<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="c1">% L1-minimization</span>
<span class="p">[</span><span class="n">c1</span><span class="p">,</span> <span class="n">fitinfo</span><span class="p">]</span> <span class="o">=</span> <span class="n">lasso</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s1">'Lambda'</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="c1">% If use L1-magic</span>
<span class="c1">% addpath /path/to/l1magic/Optimization</span>
<span class="c1">% [c1] = l1eq_pd(c0, A, [], b, 1e-4);</span>
<span class="nb">subplot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
<span class="nb">stem</span><span class="p">(</span><span class="n">c1</span><span class="p">);</span>
<span class="nb">xlim</span><span class="p">([</span><span class="mi">0</span> <span class="n">N</span><span class="p">]);</span> <span class="nb">title</span><span class="p">(</span><span class="s1">'L1 recovery - coef'</span><span class="p">);</span>

<span class="nb">subplot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">idct</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">N</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">);</span>
<span class="nb">xlim</span><span class="p">([</span><span class="mi">0</span> <span class="n">N</span><span class="p">]);</span> <span class="nb">title</span><span class="p">(</span><span class="s1">'L1 recovery - signal'</span><span class="p">);</span>
<span class="nb">legend</span><span class="p">(</span><span class="s1">'Recovered'</span><span class="p">,</span> <span class="s1">'Original'</span><span class="p">);</span></code></pre></figure>

<p>The above shows that L1-minimization successfully recovered the original signal.
A complete code snippet can be found <a href="https://gist.github.com/842145ae48381a5a8dca">here</a>.</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:Nsamples" role="doc-endnote">
      <p>In order to recover f perfectly, we need at least \(B \log (N)\) samples <a href="http://users.ece.gatech.edu/~justin/l1magic/downloads/papers/CandesRombergTao_revisedNov2005.pdf">(source)</a>. <a href="#fnref:Nsamples" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

        </div>

        

        
          

        

        <nav class="page-pagination" role="navigation">
  
    <a class="page-previous" href="/2014/05/15/a-comparison-of-least-square-l2-regularization-and-l1-regularization">
      <h4 class="page-pagination-label">Previous</h4>
      <span class="page-pagination-title">
        <i class="fas fa-arrow-left"></i> A Comparison of Least Square, L2-regularization and L1-regularization

      </span>
    </a>
  

  
    <a class="page-next" href="/2014/05/19/sparse-image-reconstruction-via-l1-minimization">
      <h4 class="page-pagination-label">Next</h4>
      <span class="page-pagination-title">
        Sparse Image Reconstruction via L1-minimization
 <i class="fas fa-arrow-right"></i>
      </span>
    </a>
  
</nav>

      </div>
    </div>
  </article>
</main>


    <footer id="footer" class="site-footer">
  <!-- start custom footer snippets -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
  TeX: {
    extensions: ["mediawiki-texvc.js"],
    Macros: {
      complex: ['\\mathbb{C}'],
      norm: ['\\left\\lVert#1\\right\\rVert', 1],
      given: ['\\mathbin{\\vert}'],
      data: ['\\mathcal{D}'],
      argmax: ['\\mathop{\\arg\\,\\max}\\limits'],
    }
  }
  });
</script>
<!-- end custom footer snippets -->
<div class="social-icons"><a class="social-icon" href="https://about.me/iveney"><i class="fas fa-external-link-square-alt fa-2x" title="About"></i></a><a class="social-icon" href="https://twitter.com/ivanzxiao"><i class="fab fa-twitter-square fa-2x" title="Twitter"></i></a><a class="social-icon" href="https://github.com/iveney"><i class="fab fa-github-square fa-2x" title="GitHub"></i></a><a class="social-icon" href="https://www.linkedin.com/in/zgxiao/"><i class="fab fa-linkedin fa-2x" title="LinkedIn"></i></a><a class="social-icon" href="/atom.xml"><i class="fas fa-rss-square fa-2x" title="Feed"></i></a></div><div class="copyright">
    
      <p>&copy; 2021 Ivan Xiao. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/mmistakes/so-simple-theme" rel="nofollow">So Simple</a>.</p>
    
  </div>
</footer>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script src="/assets/js/main.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.0.12/js/all.js"></script>


<!-- MathJax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  </body>

</html>
